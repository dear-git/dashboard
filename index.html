<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Substation Circuit Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .charts-section {
            padding: 30px;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .chart-title {
            font-size: 1.3em;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }
        
        .substations-section {
            background: white;
            margin: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .section-header {
            background: #34495e;
            color: white;
            padding: 20px 30px;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .filter-controls {
            padding: 20px 30px;
            background: #ecf0f1;
            border-bottom: 1px solid #bdc3c7;
        }
        
        .filter-select {
            padding: 10px 15px;
            border: 2px solid #bdc3c7;
            border-radius: 5px;
            font-size: 1em;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }
        
        .filter-select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .substations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 30px;
        }
        
        .substation-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .substation-card:hover {
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
        }
        
        .substation-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .substation-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .substation-code {
            background: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .substation-area {
            background: #e74c3c;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .substations-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>Substation Circuit Dashboard</h1>
            <p>ABB 115kV Equipment Analysis & Monitoring</p>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalCircuits">146</div>
                <div class="stat-label">Total Circuits</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalSubstations">35</div>
                <div class="stat-label">Total Substations</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalAreas">8</div>
                <div class="stat-label">Service Areas</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalEquipment">177</div>
                <div class="stat-label">Total Equipment</div>
            </div>
        </div>
        
        <div class="charts-section">
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title">Circuit Count by Area</div>
                    <canvas id="circuitsByAreaChart"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Substation Count by Area</div>
                    <canvas id="substationsByAreaChart"></canvas>
                </div>
            </div>
            
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title">Equipment by Model</div>
                    <canvas id="modelChart"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Equipment Age Distribution</div>
                    <canvas id="ageChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="substations-section">
            <div class="section-header">
                Substations Directory (<span id="substationCount">35 substations</span>)
            </div>
            <div class="filter-controls">
                <label for="areaFilter" style="margin-right: 10px; font-weight: bold;">Filter by Area:</label>
                <select id="areaFilter" class="filter-select">
                    <option value="all">All Areas</option>
                </select>
            </div>
            <div class="substations-grid" id="substationsGrid">
                <!-- Substations will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Dashboard data
        const dashboardData = {
            circuitsByArea: {"C2":35,"C3":20,"C1":65,"N2":4,"S2":4,"NE3":8,"N1":6,"S3":4},
            substationsByArea: {"C2":9,"C3":6,"C1":14,"N2":1,"S2":1,"NE3":2,"N1":1,"S3":1},
            modelCounts: {"ELK-04":126,"EXK":17,"ELK-CB0":10,"PASS MO SBB":1,"EXK-0":22,"BES 7":1},
            ageDistribution: {"6-10 years":66,"11-15 years":24,"20+ years":26,"16-20 years":22,"0-5 years":39},
            allSubstations: [
                {"name":"อมตะนคร 3","code":"AKC","area":"C2"},
                {"name":"อ้อมน้อย 4","code":"OND","area":"C3"},
                {"name":"อ่างทอง 1","code":"ATO","area":"C1"},
                {"name":"บ้านบึง 3 (ชั่วคราว)","code":"BBT","area":"C2"},
                {"name":"สามพราน 3","code":"SPT","area":"C3"},
                {"name":"บางพระครู","code":"BPK","area":"C1"},
                {"name":"เอกชัย 2","code":"EKT","area":"C3"},
                {"name":"โรจนะ 5","code":"RJF","area":"C1"},
                {"name":"กระทุ่มแบน 6 (ชั่วคราว)","code":"KTT","area":"C3"},
                {"name":"บางกะดี 1","code":"BKO","area":"C1"},
                {"name":"บางสมัคร 3","code":"BST","area":"C2"},
                {"name":"รังสิต 2 (ชั่วคราว)","code":"RST","area":"C1"},
                {"name":"บางกระสั้น 2","code":"BKT","area":"C1"},
                {"name":"นวนคร 3","code":"NKT","area":"C1"},
                {"name":"สระบุรี 2","code":"SBT","area":"C1"},
                {"name":"บ้านเลน 2","code":"BLT","area":"C1"},
                {"name":"หนองแค 1","code":"NKO","area":"C1"},
                {"name":"บางเลน 2 (ชั่วคราว)","code":"BLTe","area":"C1"},
                {"name":"คลองเจ็ด","code":"KJO","area":"C1"},
                {"name":"บ้านใหม่ 1","code":"BMO","area":"C1"},
                {"name":"รังสิต 1","code":"RSO","area":"C1"},
                {"name":"ฉะเชิงเทรา 2","code":"CCT","area":"C2"},
                {"name":"บางปลา","code":"BPO","area":"C3"},
                {"name":"จอมเทียน 2","code":"JTT","area":"C2"},
                {"name":"อ้อมใหญ่ 4","code":"OYF","area":"C3"},
                {"name":"ระยอง 4","code":"RYF","area":"C2"},
                {"name":"พิษณุโลก 5","code":"PLF","area":"N2"},
                {"name":"พัทยากลาง","code":"PTK","area":"C2"},
                {"name":"ภูเก็ต 3","code":"PKT","area":"S2"},
                {"name":"พัทยาใต้ 1","code":"PTO","area":"C2"},
                {"name":"นครราชสีมา 4","code":"NRF","area":"NE3"},
                {"name":"นครราชสีมา 6","code":"NRS","area":"NE3"},
                {"name":"เชียงใหม่ 2","code":"CMT","area":"N1"},
                {"name":"หาดใหญ่ 5","code":"HYF","area":"S3"},
                {"name":"พัทยาเหนือ 2","code":"PNT","area":"C2"}
            ],
            totalCircuits: 146,
            totalSubstations: 35
        };

        // Chart colors
        const colors = [
            '#3498db', '#e74c3c', '#2ecc71', '#f39c12', '#9b59b6',
            '#1abc9c', '#34495e', '#e67e22', '#95a5a6', '#f1c40f'
        ];

        // Initialize charts
        function initCharts() {
            // Circuits by Area Chart
            const circuitCtx = document.getElementById('circuitsByAreaChart').getContext('2d');
            new Chart(circuitCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(dashboardData.circuitsByArea),
                    datasets: [{
                        data: Object.values(dashboardData.circuitsByArea),
                        backgroundColor: colors,
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: {
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });

            // Substations by Area Chart
            const substationCtx = document.getElementById('substationsByAreaChart').getContext('2d');
            new Chart(substationCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(dashboardData.substationsByArea),
                    datasets: [{
                        data: Object.values(dashboardData.substationsByArea),
                        backgroundColor: colors,
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: {
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });

            // Model Chart
            const modelCtx = document.getElementById('modelChart').getContext('2d');
            new Chart(modelCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(dashboardData.modelCounts),
                    datasets: [{
                        label: 'Equipment Count',
                        data: Object.values(dashboardData.modelCounts),
                        backgroundColor: colors[0],
                        borderColor: colors[0],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 10
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45
                            }
                        }
                    }
                }
            });

            // Age Distribution Chart
            const ageCtx = document.getElementById('ageChart').getContext('2d');
            new Chart(ageCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(dashboardData.ageDistribution),
                    datasets: [{
                        label: 'Equipment Count',
                        data: Object.values(dashboardData.ageDistribution),
                        backgroundColor: colors.slice(0, Object.keys(dashboardData.ageDistribution).length),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 5
                            }
                        }
                    }
                }
            });
        }

        // Initialize substations list
        function initSubstations() {
            const areaFilter = document.getElementById('areaFilter');
            const substationsGrid = document.getElementById('substationsGrid');
            
            // Populate area filter
            const areas = [...new Set(dashboardData.allSubstations.map(s => s.area))].sort();
            areas.forEach(area => {
                const option = document.createElement('option');
                option.value = area;
                option.textContent = area;
                areaFilter.appendChild(option);
            });

            // Display substations function
            function displaySubstations(filterArea = 'all') {
                const filteredSubstations = filterArea === 'all' 
                    ? dashboardData.allSubstations 
                    : dashboardData.allSubstations.filter(s => s.area === filterArea);

                // Update substation count in header
                const countText = filterArea === 'all' 
                    ? `${filteredSubstations.length} substations`
                    : `${filteredSubstations.length} substations in ${filterArea}`;
                document.getElementById('substationCount').textContent = countText;

                substationsGrid.innerHTML = '';
                
                filteredSubstations.sort((a, b) => a.name.localeCompare(b.name, 'th')).forEach(substation => {
                    const card = document.createElement('div');
                    card.className = 'substation-card';
                    card.innerHTML = `
                        <div class="substation-name">${substation.name}</div>
                        <div class="substation-details">
                            <span class="substation-code">${substation.code}</span>
                            <span class="substation-area">${substation.area}</span>
                        </div>
                    `;
                    substationsGrid.appendChild(card);
                });
            }

            // Initial display
            displaySubstations();

            // Filter change handler
            areaFilter.addEventListener('change', (e) => {
                displaySubstations(e.target.value);
            });
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            initSubstations();
        });
    </script>
</body>
</html>